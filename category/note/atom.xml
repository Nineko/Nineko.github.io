<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://nineko.github.io</id>
    <title>Nineko&#39;s Blog • Posts by &#34;note&#34; category</title>
    <link href="https://nineko.github.io" />
    <updated>2020-08-03T07:55:22.000Z</updated>
    <category term="QT" />
    <category term="DNN" />
    <category term="Computer Vision" />
    <category term="Pose Estimation" />
    <entry>
        <id>https://nineko.github.io/2020/08/03/Note-BasicSequenceModel/</id>
        <title>[筆記]序列模型(1)-基本序列模型</title>
        <link rel="alternate" href="https://nineko.github.io/2020/08/03/Note-BasicSequenceModel/"/>
        <content type="html">&lt;h1&gt;目錄&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;基本序列模型&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;多尺度架構&lt;/p&gt;
&lt;p&gt;捷徑架構&lt;/p&gt;
&lt;h1&gt;基本序列模型&lt;/h1&gt;
&lt;p&gt;  序列模型為建構深度學習網路時最直觀也最簡便的方式，在大多數時候，序列模型往往能夠讓你在解決問題上提供一個初步的解決方案。&lt;/p&gt;
&lt;p&gt;不過儘管它如此單純，依舊值得好好研究，在本篇中將會從最基本的開始說明，也就是沒有任何特別操作，單純一層疊一層的方式來建構深度學習網路。&lt;/p&gt;
&lt;p&gt;這種方式在初期被大量使用，它方便架設，也很容易理解，但是它因簡單的架構，無法處理太過於複雜的特徵，也沒有任何機制去降低計算量，可說是有利有弊。&lt;/p&gt;
&lt;h2&gt;建構&lt;/h2&gt;
&lt;h3&gt;全連接層&lt;/h3&gt;
&lt;p&gt;在這個筆記裡，範例皆為 Keras 實做版本，Keras 版本為 2.4.3 ，基底 Tensorflow 版本為 2.3.0 。&lt;/p&gt;
&lt;p&gt;假設我們想要建構一個輸入長度為 100 的向量，經過兩層輸出為 50 的隱藏層後，最後輸出長度為 10 的向量。&lt;/p&gt;
&lt;p&gt;在 Keras 中，我們可以使用很簡單的方式來建構一個序列模型。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import tensorflow as tf
from keras.models import Model
from keras.layers import Input,Dense
from keras import backend as K

def SequenceModel():

    # 輸入層
    model_input &amp;#x3D; Input(shape&amp;#x3D;(100), name&amp;#x3D;&amp;#39;input&amp;#39;)
    # 隱藏層 1 
    hidden &amp;#x3D; Dense(50, activation&amp;#x3D;&amp;#39;sigmoid&amp;#39;,name&amp;#x3D;&amp;quot;hidden_1&amp;quot;)(model_input)
    # 隱藏層 2 
    hidden &amp;#x3D; Dense(50, activation&amp;#x3D;&amp;#39;sigmoid&amp;#39;,name&amp;#x3D;&amp;quot;hidden_2&amp;quot;)(hidden)
    # 輸出層 
    model_output &amp;#x3D; Dense(10, activation&amp;#x3D;&amp;#39;sigmoid&amp;#39;,name&amp;#x3D;&amp;quot;output&amp;quot;)(hidden)

    model &amp;#x3D; Model(inputs&amp;#x3D;[model_input], outputs&amp;#x3D;[model_output])

    return model&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;  可以看到由 Keras 建構只需要專心建構網路的架構，而不需要做 Weight 及 Bias 的數量及初始化定義，它會以預設的參數進行建構，若要修改也可以帶入引數進行設定。&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;figcaption&gt;&lt;span class=&#34;lang&#34;&gt;python&lt;/span&gt;&lt;/figcaption&gt;&lt;div class=&#34;code-container&#34;&gt;&lt;pre class=&#34;gutter&#34;&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;&lt;/pre&gt;&lt;pre class=&#34;code&#34;&gt;keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;layers&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Dense&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;units&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;br&gt;                   activation&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;br&gt;                   use_bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;br&gt;                   kernel_initializer&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;glorot_uniform&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias_initializer&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;zeros&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;br&gt;                   kernel_regularizer&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;br&gt;                   bias_regularizer&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;br&gt;                   activity_regularizer&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;br&gt;                   kernel_constraint&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;br&gt;                   bias_constraint&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;若要了解更詳細的設定可以查看 &lt;a href=&#34;https://keras.io/api/layers/core_layers/dense/&#34;&gt;Keras 手冊&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;卷積層&lt;/h3&gt;
&lt;p&gt;  若要建構一個 DNN ，卷積層是必須的，與全連接層相同的做法，只是呼叫的函式不同而已。&lt;/p&gt;
&lt;p&gt;  在接下來的範例中，輸入張量為 100x100x3 ，經過兩層 50 個卷積核為 3x3 ，Stride 為 2 ，不使用 Padding 的卷積層後，進行 Flatten ，最後再接入向量長度為 10 的輸出層。&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;figcaption&gt;&lt;span class=&#34;lang&#34;&gt;python&lt;/span&gt;&lt;/figcaption&gt;&lt;div class=&#34;code-container&#34;&gt;&lt;pre class=&#34;gutter&#34;&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;br&gt;11&lt;br&gt;12&lt;br&gt;13&lt;br&gt;14&lt;br&gt;15&lt;br&gt;16&lt;br&gt;17&lt;br&gt;18&lt;br&gt;19&lt;br&gt;20&lt;br&gt;21&lt;br&gt;&lt;/pre&gt;&lt;pre class=&#34;code&#34;&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; tensorflow &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; tf&lt;br&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;models &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Model&lt;br&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;layers &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Input&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;Dense&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;Conv2D&lt;br&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; keras &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; backend &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; K&lt;br&gt;&lt;br&gt;&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;SequenceModel&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;token comment&#34;&gt;# 輸入層&lt;/span&gt;&lt;br&gt;    model_input &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Input&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;shape&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; name&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;input&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;token comment&#34;&gt;# 隱藏層 1 &lt;/span&gt;&lt;br&gt;    hidden &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Conv2D&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; activation&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;relu&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; padding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;valid&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;name&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;hidden_1&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;model_input&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;token comment&#34;&gt;# 隱藏層 2 &lt;/span&gt;&lt;br&gt;    hidden &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Conv2D&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; activation&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;relu&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; padding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;valid&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;name&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;hidden_2&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;model_input&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;token comment&#34;&gt;# Flatten&lt;/span&gt;&lt;br&gt;    Flatten_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Flatten&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;name&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;flatten&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;hidden&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;token comment&#34;&gt;# 輸出層 &lt;/span&gt;&lt;br&gt;    model_output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Dense&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; activation&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;sigmoid&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;name&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;output&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;Flatten_layer&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;br&gt;&lt;br&gt;    model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Model&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;inputs&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;model_input&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; outputs&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;model_output&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; model&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;同樣，這只是最基本的應用，若要更進階的使用請詳看 &lt;a href=&#34;https://keras.io/api/layers/convolution_layers/&#34;&gt;Keras 手冊&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;  以上，我們已經知道該怎麼建構卷積層及全連接層，使用這兩者已經可以建構一個影像辨識的應用，像是一開始的 AlexNet 及 VGG 系列都是使用單純的卷積加上全連接層建構而成的，接下來，你可以建構自己的架構嘗試進行影像辨識，可以使用&lt;a href=&#34;http://yann.lecun.com/exdb/mnist/&#34;&gt;手寫辨識 MINST&lt;/a&gt; 或是 &lt;a href=&#34;https://www.kaggle.com/c/dogs-vs-cats&#34;&gt;Kaggle 的 Dogs v.s Cats&lt;/a&gt; 進行練習。&lt;/p&gt;
</content>
        <category term="DNN" />
        <updated>2020-08-03T07:55:22.000Z</updated>
    </entry>
</feed>
